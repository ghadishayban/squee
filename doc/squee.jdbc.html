<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>squee.jdbc documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Squee 0.0.1 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>squee</span></div></div></li><li class="depth-2 branch"><a href="squee.datasources.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>datasources</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-3"><a href="squee.impl.protocols.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocols</span></div></a></li><li class="depth-2 current"><a href="squee.jdbc.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>jdbc</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="squee.jdbc.html#var-connect.21"><div class="inner"><span>connect!</span></div></a></li><li class="depth-1"><a href="squee.jdbc.html#var-default-rs-fn"><div class="inner"><span>default-rs-fn</span></div></a></li><li class="depth-1"><a href="squee.jdbc.html#var-do-commands"><div class="inner"><span>do-commands</span></div></a></li><li class="depth-1"><a href="squee.jdbc.html#var-execute.21"><div class="inner"><span>execute!</span></div></a></li><li class="depth-1"><a href="squee.jdbc.html#var-execute-against-connection*"><div class="inner"><span>execute-against-connection*</span></div></a></li><li class="depth-1"><a href="squee.jdbc.html#var-insert-sql"><div class="inner"><span>insert-sql</span></div></a></li><li class="depth-1"><a href="squee.jdbc.html#var-many"><div class="inner"><span>many</span></div></a></li><li class="depth-1"><a href="squee.jdbc.html#var-params"><div class="inner"><span>params</span></div></a></li><li class="depth-1"><a href="squee.jdbc.html#var-query"><div class="inner"><span>query</span></div></a></li><li class="depth-1"><a href="squee.jdbc.html#var-reducible-result-set"><div class="inner"><span>reducible-result-set</span></div></a></li><li class="depth-1"><a href="squee.jdbc.html#var-transactionally"><div class="inner"><span>transactionally</span></div></a></li><li class="depth-1"><a href="squee.jdbc.html#var-with-connection"><div class="inner"><span>with-connection</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">squee.jdbc</h2><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-connect.21"><h3>connect!</h3><div class="usage"><code>(connect! db f a)</code><code>(connect! db f a b)</code><code>(connect! db f a b c)</code><code>(connect! db f a b c &amp; args)</code></div><div class="doc"><pre class="plaintext">Helper, equivalent to
 (with-connection [conn db-spec]
   (f conn .. args)
and in the spirit of update-in/update/swap!, etc.

(connect! &quot;db query select * from foo where x = ?&quot; (params a))</pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L192">view source</a></div></div><div class="public anchor" id="var-default-rs-fn"><h3>default-rs-fn</h3><div class="usage"><code>(default-rs-fn opts)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L87">view source</a></div></div><div class="public anchor" id="var-do-commands"><h3>do-commands</h3><div class="usage"><code>(do-commands conn &amp; commands)</code></div><div class="doc"><pre class="plaintext">Runs a set of commands against the database.
</pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L212">view source</a></div></div><div class="public anchor" id="var-execute.21"><h3>execute!</h3><div class="usage"><code>(execute! conn sql)</code><code>(execute! conn sql params)</code><code>(execute! conn sql params opts)</code></div><div class="doc"><pre class="plaintext">Execute an SQL query against a Connection or open transaction.
params is a function that parameterizes the query, like #&apos;params

Examples:
(query conn &quot;select * from bar&quot;)

(query conn &quot;select * from foo where x = ? and y = ? &quot; (params 4 5))

Supports all opts that #&apos;query supports
Additionally `:return-keys? true`  will return database-generated keys.</pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L152">view source</a></div></div><div class="public anchor" id="var-execute-against-connection*"><h3>execute-against-connection*</h3><div class="usage"><code>(execute-against-connection* conn create-jdbc-statement parameterize! realize!)</code></div><div class="doc"><pre class="plaintext">Low-level.

conn                  java.sql.Connection
create-jdbc-statement function of a Connection -&gt; Statement or PreparedStatement
parameterize!         side-effecting function of a PreparedStatement.
realize!              fn of a PreparedStatement whose return value is returned.</pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L59">view source</a></div></div><div class="public anchor" id="var-insert-sql"><h3>insert-sql</h3><div class="usage"><code>(insert-sql table &amp; cols)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L170">view source</a></div></div><div class="public anchor" id="var-many"><h3>many</h3><h4 class="type">macro</h4><div class="usage"><code>(many params)</code></div><div class="doc"><pre class="plaintext">Returns a params function that parameterizes an SQL statement *multiple* times.

Takes a collection of collections.</pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L80">view source</a></div></div><div class="public anchor" id="var-params"><h3>params</h3><div class="usage"><code>(params &amp; xs)</code></div><div class="doc"><pre class="plaintext">Returns a params function that parameterizes an SQL statement *once*.

Takes multiple arguments</pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L71">view source</a></div></div><div class="public anchor" id="var-query"><h3>query</h3><div class="usage"><code>(query conn sql)</code><code>(query conn sql params)</code><code>(query conn sql params opts)</code></div><div class="doc"><pre class="plaintext">Execute an SQL query against a Connection or open transaction.
params is a function that parameterizes the query, like #&apos;params

Examples:
(query conn &quot;select * from bar&quot;)

(query conn &quot;select * from foo where x = ? and y = ? &quot; (params 4 5))

opts supported:
 :result-type :forward-only | :scroll-insensitive | :scroll-sensitive
 :concurrency :read-only | :updatable
 :cursors
 :fetch-size n
 :max-rows n
 :timeout n

 :create-statement!  Providing this function (of a Connection) will override the above arguments

 :result-set-fn      By default, this turns the ResultSet into a vector of maps.

 Described in #&apos;reducible-result-set:
 :row-strategy
 :name-keys</pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L102">view source</a></div></div><div class="public anchor" id="var-reducible-result-set"><h3>reducible-result-set</h3><div class="usage"><code>(reducible-result-set rs opts)</code></div><div class="doc"><pre class="plaintext">Low-level. Takes a result set and an option map, returns a 
reducible collection (clojure.lang.IReduceInit) on the result-set.

opts supported:

:row-strategy   something that extends RowGenerator. The
                 default RowGenerator turns rows into maps.
:name-keys      a function that takes one arg, a collection keys,
                 and somehow transforms them. The default one
                 dedups, lower-cases, and keywordizes them.</pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L43">view source</a></div></div><div class="public anchor" id="var-transactionally"><h3>transactionally</h3><h4 class="type">macro</h4><div class="usage"><code>(transactionally conn &amp; body)</code></div><div class="doc"><pre class="plaintext">Takes a Connection (or open transaction) and performs its
body within a transaction.  Arbitrarily nestable, but
if an inner transaction rolls back on uncaught exception,
the outermost will rollback as well.

Takes an *optional* opts map between the connection and the body,
which supports :isolation and :read-only? options.

Isolation levels:
:none :read-committed :read-uncommitted :repeatable-read :serializable

Example usage:

(transactionally conn
   (execute! conn ...)
   (query conn ...)
   (execute! conn ...))</pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L16">view source</a></div></div><div class="public anchor" id="var-with-connection"><h3>with-connection</h3><h4 class="type">macro</h4><div class="usage"><code>(with-connection binding &amp; body)</code></div><div class="doc"><pre class="plaintext">Macro that opens a connection from the provided spec, which must be
one of the extenders of IDataSource.

(with-connection [conn some-IDataSource])
  .... body)</pre></div><div class="src-link"><a href="http://github.com/ghadishayban/squee/blob/master/src/squee/jdbc.clj#L182">view source</a></div></div></div></body></html>